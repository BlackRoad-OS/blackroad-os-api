openapi: 3.0.3
info:
  title: BlackRoad OS API
  version: 0.1.0
servers:
  - url: http://localhost:3001
    description: Local development
  - url: https://api.blackroad.systems
    description: Production gateway
paths:
  /health:
    get:
      summary: Health check
      responses:
        "200":
          description: Service health
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  uptimeSeconds:
                    type: number
                  env:
                    type: string
  /version:
    get:
      summary: Version info
      responses:
        "200":
          description: Service version metadata
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                  gitSha:
                    type: string
                  buildTime:
                    type: string
                  env:
                    type: string
  /finance/summary:
    get:
      summary: Finance summary
      responses:
        "200":
          description: Finance snapshot
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FinanceSummaryResponse'
  /finance/cash-forecast:
    get:
      summary: Cash forecast
      responses:
        "200":
          description: Cash forecast buckets
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CashForecastResponse'
  /finance/statements/{period}:
    get:
      summary: Financial statements
      parameters:
        - in: path
          name: period
          required: true
          description: Period identifier (YYYY-MM or YYYY-Qn)
          schema:
            type: string
      responses:
        "200":
          description: Financial statements for period
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FinancialStatementsResponse'
        "400":
          description: Invalid period
components:
  schemas:
    FinanceSummary:
      type: object
      properties:
        currency:
          type: string
        cashBalance:
          type: number
        monthlyBurnRate:
          type: number
        runwayMonths:
          type: number
        mrr:
          type: number
        arr:
          type: number
        generatedAt:
          type: string
          format: date-time
    CashForecastBucket:
      type: object
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        netChange:
          type: number
        endingBalance:
          type: number
    CashForecast:
      type: object
      properties:
        currency:
          type: string
        buckets:
          type: array
          items:
            $ref: '#/components/schemas/CashForecastBucket'
        generatedAt:
          type: string
          format: date-time
    StatementLineItem:
      type: object
      properties:
        account:
          type: string
        label:
          type: string
        amount:
          type: number
    IncomeStatement:
      type: object
      properties:
        period:
          type: string
        currency:
          type: string
        revenue:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        cogs:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        operatingExpenses:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        otherIncomeExpenses:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        netIncome:
          type: number
    BalanceSheet:
      type: object
      properties:
        period:
          type: string
        currency:
          type: string
        assets:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        liabilities:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        equity:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
    CashFlowStatement:
      type: object
      properties:
        period:
          type: string
        currency:
          type: string
        operatingActivities:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        investingActivities:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        financingActivities:
          type: array
          items:
            $ref: '#/components/schemas/StatementLineItem'
        netChangeInCash:
          type: number
    FinancialStatements:
      type: object
      properties:
        period:
          type: string
        incomeStatement:
          $ref: '#/components/schemas/IncomeStatement'
        balanceSheet:
          $ref: '#/components/schemas/BalanceSheet'
        cashFlowStatement:
          $ref: '#/components/schemas/CashFlowStatement'
    FinanceSummaryResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/FinanceSummary'
    CashForecastResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/CashForecast'
    FinancialStatementsResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/FinancialStatements'
